{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "https://bank.solidnetwork.xyz CloudFront distribution.",
  "Parameters" : {
    "ExtraParameter" : {
      "Type" : "String"
    },
    "WebsiteURL":{
      "Type" : "String",
      "Default" : "T6-Bucket-S3-bank-solidnetwork-xyz"
    }
  }
  "Resources": {
    "BankSolidnetworkXyzDistribution": {
      "Type": "AWS::CloudFront::Distribution",
      "Properties": {
        "DistributionConfig": {
          "Aliases": [
            "bank.solidnetwork.xyz"
          ],
          "Comment": "S3>bank.solidnetwork.xyz",
          "CustomErrorResponses": [
            {
              "ErrorCachingMinTTL": 10,
              "ErrorCode": 400,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            },
            {
              "ErrorCachingMinTTL": 10,
              "ErrorCode": 403,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            },
            {
              "ErrorCachingMinTTL": 10,
              "ErrorCode": 404,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            },
            {
              "ErrorCachingMinTTL": 10,
              "ErrorCode": 500,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            },
            {
              "ErrorCachingMinTTL": 10,
              "ErrorCode": 501,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            },
            {
              "ErrorCachingMinTTL": 10,
              "ErrorCode": 502,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            }
          ],
          "DefaultCacheBehavior": {
            "AllowedMethods": [
              "GET",
              "HEAD",
              "OPTIONS",
              "POST"
            ],
            "Compress": true,
            "ForwardedValues": {
              "Cookies": {
                "Forward": "none"
              },
              "QueryString": false
            },
            "TargetOriginId": "origin.bank.solidnetwork.xyz",
            "ViewerProtocolPolicy": "redirect-to-https"
          },
          "DefaultRootObject": "index.html",
          "Enabled": true,
          "HttpVersion": "http2",
          "Origins": [
            {
              "CustomOriginConfig": {
                "HTTPPort": 80,
                "OriginProtocolPolicy": "http-only"
              },
              "DomainName": {
                 "Fn::ImportValue": {
                  "Fn::Sub": "${WebsiteURL}-URL"
                }               
              },
              "Id": "origin.bank.solidnetwork.xyz"
            }
          ],
          "ViewerCertificate": {
            "AcmCertificateArn": {
             "Ref" : "ExtraParameter"
          },
            "MinimumProtocolVersion": "TLSv1.2_2021",
            "SslSupportMethod": "sni-only"
          }
        }
      }
    }
  },
  "Outputs": {
    "BankSolidnetworkXyzDistributionValue": {
      "Description": "CloudFront distribution created.",
      "Value": {
        "Ref": "BankSolidnetworkXyzDistribution"
      }
    }
  }
}
